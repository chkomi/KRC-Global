<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>상하이 11월 여행 계획</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
            height: 100vh;
            overflow: hidden;
        }

        /* 상단 타이틀 박스 */
        .title-box {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(44, 62, 80, 0.95);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .title-box h1 {
            margin: 0;
            font-size: 1.4em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 전체 화면 지도 */
        #map {
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }

        /* 범례 박스 */
        .legend-box {
            position: absolute;
            top: 80px;
            right: 15px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            max-width: 200px;
        }

        .legend-box h3 {
            margin: 0 0 12px 0;
            color: #2c3e50;
            font-size: 1em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-box ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .legend-box li {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.85em;
        }

        .marker-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
            color: white;
            font-size: 10px;
            font-weight: bold;
        }

        .tourism-marker { background-color: #e74c3c; }
        .restaurant-marker { background-color: #27ae60; }
        .airport-marker { background-color: #9b59b6; }
        .accommodation-marker { background-color: #3498db; }

        /* 장소 정보 박스 */
        .info-box {
            position: absolute;
            bottom: 15px;
            left: 15px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            max-width: 350px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }

        .info-box.show {
            display: block;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .info-box h3 {
            margin: 0 0 12px 0;
            color: #2c3e50;
            font-size: 1.1em;
            border-left: 4px solid #3498db;
            padding-left: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-box p {
            margin: 6px 0;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .info-box strong {
            color: #3498db;
            font-weight: 600;
        }

        .place-type-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            color: white;
            font-size: 0.75em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .type-관광지 { background-color: #e74c3c; }
        .type-음식점 { background-color: #27ae60; }
        .type-airport { background-color: #9b59b6; }
        .type-accommodation { background-color: #3498db; }

        .rating-stars {
            color: #f39c12;
            margin-left: 5px;
            font-size: 0.9em;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.2em;
            color: #7f8c8d;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background-color: #ecf0f1;
            color: #2c3e50;
        }

        /* 커스텀 마커 스타일 */
        .custom-marker-icon {
            background: transparent;
            border: none;
            border-radius: 50%;
        }

        .marker-content {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            color: white;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 3px solid white;
            transition: transform 0.2s;
        }

        .marker-content:hover {
            transform: scale(1.1);
        }

        .tourism-bg { background-color: #e74c3c; }
        .restaurant-bg { background-color: #27ae60; }
        .airport-bg { background-color: #9b59b6; }
        .accommodation-bg { background-color: #3498db; }

        /* Leaflet 툴팁 스타일 */
        .leaflet-tooltip {
            padding: 6px 12px !important;
            background-color: rgba(0, 0, 0, 0.8) !important;
            color: white !important;
            border: none !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
            font-weight: bold;
            font-size: 0.9em;
            white-space: nowrap;
            pointer-events: none;
            border-radius: 4px;
        }

        .leaflet-tooltip.leaflet-tooltip-bottom:before {
            border-top-color: rgba(0, 0, 0, 0.8) !important;
        }

        /* 반응형 디자인 */
        @media (max-width: 768px) {
            .title-box {
                top: 10px;
                left: 10px;
                right: 10px;
                transform: none;
                padding: 10px 16px;
            }

            .title-box h1 {
                font-size: 1.2em;
                text-align: center;
            }

            .legend-box {
                top: 70px;
                right: 10px;
                padding: 12px;
                max-width: 160px;
            }

            .legend-box h3 {
                font-size: 0.9em;
            }

            .legend-box li {
                font-size: 0.8em;
            }

            .info-box {
                bottom: 10px;
                left: 10px;
                right: 10px;
                max-width: none;
                padding: 15px;
            }
        }

        /* 스크롤바 스타일 */
        .info-box::-webkit-scrollbar {
            width: 6px;
        }

        .info-box::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .info-box::-webkit-scrollbar-thumb {
            background: #bdc3c7;
            border-radius: 3px;
        }

        .info-box::-webkit-scrollbar-thumb:hover {
            background: #95a5a6;
        }
    </style>
</head>
<body>
    <!-- 상단 타이틀 박스 -->
    <div class="title-box">
        <h1><i class="fas fa-map-marked-alt"></i> 상하이 여행 지도</h1>
    </div>

    <!-- 범례 박스 -->
    <div class="legend-box">
        <h3><i class="fas fa-list"></i> 범례</h3>
        <ul>
            <li>
                <div class="marker-icon tourism-marker">
                    <i class="fas fa-camera"></i>
                </div>
                관광지
            </li>
            <li>
                <div class="marker-icon restaurant-marker">
                    <i class="fas fa-utensils"></i>
                </div>
                음식점
            </li>
            <li>
                <div class="marker-icon airport-marker">
                    <i class="fas fa-plane"></i>
                </div>
                공항
            </li>
            <li>
                <div class="marker-icon accommodation-marker">
                    <i class="fas fa-bed"></i>
                </div>
                숙소
            </li>
        </ul>
    </div>

    <!-- 장소 정보 박스 -->
    <div class="info-box" id="place-details">
        <button class="close-btn" onclick="closeInfoBox()">
            <i class="fas fa-times"></i>
        </button>
        <div id="place-content">
            <!-- 장소 정보가 여기에 표시됩니다 -->
        </div>
    </div>

    <!-- 전체 화면 지도 -->
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // 상하이 데이터
        const shanghaiData = {
            "places": [
                {
                    "name": "상하이 푸동 국제공항 (PVG)",
                    "type": "airport",
                    "latitude": 31.1443,
                    "longitude": 121.8058,
                    "feature": "상하이의 주요 국제 관문",
                    "주소": "Shanghai, Pudong, China",
                    "추천_방문일차": "도착/출발",
                    "평점": 4.0,
                    "영업시간": "24시간",
                    "전화번호": "+86 21 96990"
                },
                {
                    "name": "상하이 인민로 839호 숙소 1안",
                    "type": "accommodation",
                    "latitude": 31.2275837,
                    "longitude": 121.4847172,
                    "feature": "상하이 시내 중심 황푸구 위치, 접근성 좋음",
                    "주소": "No. 839 Renmin Road, Huangpu District, Shanghai, China",
                    "추천_방문일차": "매일",
                    "평점": 4.5,
                    "영업시간": "체크인/아웃 기준",
                    "전화번호": "확인 필요"
                },
                {
                    "name": "와이탄 (The Bund)",
                    "type": "관광지",
                    "latitude": 31.2386,
                    "longitude": 121.4903,
                    "feature": "황푸강을 따라 펼쳐진 상하이의 상징적인 스카이라인과 유럽풍 건축물이 어우러진 야경 명소",
                    "주소": "Zhongshan East 1st Rd, Huangpu, Shanghai, China",
                    "추천_방문일차": "1일차",
                    "평점": 4.7,
                    "영업시간": "24시간",
                    "전화번호": "없음"
                },
                {
                    "name": "동방명주 타워 (Oriental Pearl Tower)",
                    "type": "관광지",
                    "latitude": 31.2418,
                    "longitude": 121.4951,
                    "feature": "상하이의 랜드마크로, 360도 전망대와 투명 스카이워크가 인기",
                    "주소": "1 Century Ave, Pudong, Shanghai, China",
                    "추천_방문일차": "1일차",
                    "평점": 4.5,
                    "영업시간": "08:00-22:00",
                    "전화번호": "+86 21 5879 1888"
                },
                {
                    "name": "예원 (Yu Garden)",
                    "type": "관광지",
                    "latitude": 31.2278,
                    "longitude": 121.4925,
                    "feature": "명나라 시대의 고전 정원으로, 전통 중국 건축과 정원을 감상 가능",
                    "주소": "279 Yuyuan Old St, Huangpu, Shanghai, China",
                    "추천_방문일차": "2일차",
                    "평점": 4.6,
                    "영업시간": "08:30-17:00",
                    "전화번호": "+86 21 6326 0830"
                },
                {
                    "name": "상하이 타워 (Shanghai Tower)",
                    "type": "관광지",
                    "latitude": 31.2356,
                    "longitude": 121.5010,
                    "feature": "세계에서 두 번째로 높은 마천루로, 118층 전망대에서 상하이 전경 조망",
                    "주소": "501 Yincheng Middle Rd, Pudong, Shanghai, China",
                    "추천_방문일차": "1일차",
                    "평점": 4.6,
                    "영업시간": "08:30-22:00",
                    "전화번호": "+86 21 2065 6999"
                },
                {
                    "name": "난징루 보행자 거리 (Nanjing Road Pedestrian Street)",
                    "type": "관광지",
                    "latitude": 31.2349,
                    "longitude": 121.4750,
                    "feature": "상하이 최대의 쇼핑 거리로, 현대와 전통이 공존하는 분위기",
                    "주소": "Nanjing Rd Pedestrian St, Huangpu, Shanghai, China",
                    "추천_방문일차": "2일차",
                    "평점": 4.4,
                    "영업시간": "24시간",
                    "전화번호": "없음"
                },
                {
                    "name": "신천지 (Xintiandi)",
                    "type": "관광지",
                    "latitude": 31.2234,
                    "longitude": 121.4708,
                    "feature": "1920년대 석쿠먼 건축을 현대적으로 재현한 트렌디한 거리",
                    "주소": "Lane 181, Taicang Rd, Huangpu, Shanghai, China",
                    "추천_방문일차": "2일차",
                    "평점": 4.5,
                    "영업시간": "24시간",
                    "전화번호": "없음"
                },
                {
                    "name": "대한민국 임시정부 (Provisional Government of the Republic of Korea)",
                    "type": "관광지",
                    "latitude": 31.2217,
                    "longitude": 121.4684,
                    "feature": "한국 독립운동의 역사적 장소로, 상하이 방문 시 필수 코스",
                    "주소": "306 Madang Rd, Huangpu, Shanghai, China",
                    "추천_방문일차": "3일차",
                    "평점": 4.3,
                    "영업시간": "09:00-17:00",
                    "전화번호": "+86 21 5382 6505"
                },
                {
                    "name": "하이디라오 훠궈 (Hai Di Lao Hot Pot)",
                    "type": "음식점",
                    "latitude": 31.2356,
                    "longitude": 121.4790,
                    "feature": "한국인에게도 익숙한 중국식 샤브샤브 훠궈 체인점",
                    "주소": "6F, 299 Nanjing East Rd, Huangpu, Shanghai, China",
                    "추천_방문일차": "매일",
                    "평점": 4.6,
                    "영업시간": "10:00-02:00",
                    "전화번호": "+86 21 6328 2298"
                },
                {
                    "name": "와이포지아 (Grandma's Home)",
                    "type": "음식점",
                    "latitude": 31.2451,
                    "longitude": 121.4710,
                    "feature": "항저우 요리를 기반으로 한 가성비 좋은 중식 레스토랑",
                    "주소": "7F, Joy City, 166 Xizang North Rd, Jing'an, Shanghai, China",
                    "추천_방문일차": "매일",
                    "평점": 4.4,
                    "영업시간": "10:00-22:00",
                    "전화번호": "+86 21 6358 3999"
                },
                {
                    "name": "딘타이펑 (Din Tai Fung)",
                    "type": "음식점",
                    "latitude": 31.2368,
                    "longitude": 121.5027,
                    "feature": "세계적으로 유명한 샤오롱바오 체인점",
                    "주소": "2F, Shanghai World Financial Center, 100 Century Ave, Pudong, Shanghai, China",
                    "추천_방문일차": "매일",
                    "평점": 4.6,
                    "영업시간": "10:00-22:00",
                    "전화번호": "+86 21 6877 6888"
                }
            ]
        };

        let map;
        let markers = L.featureGroup();

        document.addEventListener('DOMContentLoaded', () => {
            initializeMap();
        });

        function initializeMap() {
            // 지도 초기화
            map = L.map('map').setView([31.2304, 121.4737], 12);

            // 지도 타일 레이어 추가
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // 마커 레이어 그룹을 지도에 추가
            markers.addTo(map);

            // 마커 표시
            displayMarkers(shanghaiData.places);
        }

        function displayMarkers(places) {
            markers.clearLayers();

            places.forEach(place => {
                const marker = L.marker([place.latitude, place.longitude], {
                    icon: createCustomIcon(place.type)
                }).addTo(markers);

                marker.bindTooltip(place.name, {
                    permanent: false,
                    direction: 'top',
                    offset: [0, -10]
                });

                marker.on('click', () => {
                    displayPlaceDetails(place);
                    map.flyTo([place.latitude, place.longitude], 15);
                });
            });

            // 모든 마커가 보이도록 지도 뷰 조정
            if (markers.getLayers().length > 0) {
                map.fitBounds(markers.getBounds().pad(0.1));
            }
        }

        function createCustomIcon(type) {
            let iconClass, bgClass;

            switch (type) {
                case '관광지':
                    iconClass = 'fas fa-camera';
                    bgClass = 'tourism-bg';
                    break;
                case '음식점':
                    iconClass = 'fas fa-utensils';
                    bgClass = 'restaurant-bg';
                    break;
                case 'airport':
                    iconClass = 'fas fa-plane';
                    bgClass = 'airport-bg';
                    break;
                case 'accommodation':
                    iconClass = 'fas fa-bed';
                    bgClass = 'accommodation-bg';
                    break;
                default:
                    iconClass = 'fas fa-map-marker-alt';
                    bgClass = 'tourism-bg';
            }

            return L.divIcon({
                className: 'custom-marker-icon',
                html: `<div class="marker-content ${bgClass}">
                         <i class="${iconClass}"></i>
                       </div>`,
                iconSize: [35, 35],
                iconAnchor: [17, 17],
                tooltipAnchor: [0, -20]
            });
        }

        function displayPlaceDetails(place) {
            const infoBox = document.getElementById('place-details');
            const placeContent = document.getElementById('place-content');
            
            let detailsHtml = `
                <div class="place-type-badge type-${place.type}">
                    ${getTypeIcon(place.type)} ${getTypeDisplayName(place.type)}
                </div>
                <h3><i class="fas fa-map-marker-alt"></i> ${place.name}</h3>
                <p><strong>🎯 특징:</strong> ${place.feature || '정보 없음'}</p>
            `;
            
            if (place.주소) {
                detailsHtml += `<p><strong>📍 주소:</strong> ${place.주소}</p>`;
            }
            
            if (place.추천_방문일차) {
                detailsHtml += `<p><strong>📅 추천:</strong> ${place.추천_방문일차}</p>`;
            }
            
            if (place.평점) {
                const stars = '★'.repeat(Math.floor(place.평점)) + '☆'.repeat(5 - Math.floor(place.평점));
                detailsHtml += `<p><strong>⭐ 평점:</strong> ${place.평점}/5 <span class="rating-stars">${stars}</span></p>`;
            }
            
            if (place.영업시간) {
                detailsHtml += `<p><strong>🕒 영업:</strong> ${place.영업시간}</p>`;
            }
            
            if (place.전화번호 && place.전화번호 !== "없음" && place.전화번호 !== "확인 필요") {
                detailsHtml += `<p><strong>📞 연락:</strong> ${place.전화번호}</p>`;
            }

            placeContent.innerHTML = detailsHtml;
            infoBox.classList.add('show');
        }

        function closeInfoBox() {
            const infoBox = document.getElementById('place-details');
            infoBox.classList.remove('show');
        }

        function getTypeIcon(type) {
            switch (type) {
                case '관광지': return '📷';
                case '음식점': return '🍴';
                case 'airport': return '✈️';
                case 'accommodation': return '🏨';
                default: return '📍';
            }
        }

        function getTypeDisplayName(type) {
            switch (type) {
                case '관광지': return '관광지';
                case '음식점': return '음식점';
                case 'airport': return '공항';
                case 'accommodation': return '숙소';
                default: return '기타';
            }
        }

        // ESC 키로 정보 박스 닫기
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeInfoBox();
            }
        });

        // 지도 클릭 시 정보 박스 닫기
        map.on('click', (e) => {
            // 마커가 아닌 지도 영역을 클릭했을 때만 닫기
            if (e.originalEvent.target === e.originalEvent.currentTarget) {
                closeInfoBox();
            }
        });
    </script>
</body>
</html>
